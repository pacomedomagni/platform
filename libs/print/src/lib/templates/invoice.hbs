<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>{{doctype}} - {{docname}}</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 11px;
      line-height: 1.4;
      color: #333;
      padding: 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #333;
    }
    .company-info {
      max-width: 60%;
    }
    .company-name {
      font-size: 24px;
      font-weight: bold;
      color: #1a1a1a;
      margin-bottom: 5px;
    }
    .company-details {
      color: #666;
      font-size: 10px;
    }
    .document-info {
      text-align: right;
    }
    .document-title {
      font-size: 28px;
      font-weight: bold;
      color: #2563eb;
      margin-bottom: 10px;
    }
    .document-number {
      font-size: 14px;
      font-weight: 600;
    }
    .document-date {
      color: #666;
      margin-top: 5px;
    }
    .parties {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-bottom: 30px;
    }
    .party-section h3 {
      font-size: 10px;
      text-transform: uppercase;
      color: #666;
      margin-bottom: 8px;
      letter-spacing: 0.5px;
    }
    .party-name {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 5px;
    }
    .party-address {
      color: #555;
      white-space: pre-line;
    }
    .items-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }
    .items-table th {
      background-color: #f3f4f6;
      padding: 10px 8px;
      text-align: left;
      font-weight: 600;
      font-size: 10px;
      text-transform: uppercase;
      color: #374151;
      border-bottom: 2px solid #e5e7eb;
    }
    .items-table td {
      padding: 12px 8px;
      border-bottom: 1px solid #e5e7eb;
      vertical-align: top;
    }
    .items-table .text-right {
      text-align: right;
    }
    .items-table .text-center {
      text-align: center;
    }
    .item-code {
      font-weight: 500;
    }
    .item-description {
      font-size: 10px;
      color: #666;
      margin-top: 2px;
    }
    .totals-section {
      display: flex;
      justify-content: flex-end;
    }
    .totals-table {
      width: 300px;
    }
    .totals-table tr td {
      padding: 8px 12px;
    }
    .totals-table tr td:first-child {
      text-align: right;
      color: #666;
    }
    .totals-table tr td:last-child {
      text-align: right;
      font-weight: 500;
    }
    .totals-table .grand-total td {
      border-top: 2px solid #333;
      font-size: 14px;
      font-weight: bold;
      padding-top: 12px;
    }
    .amount-in-words {
      margin-top: 20px;
      padding: 15px;
      background-color: #f9fafb;
      border-radius: 4px;
    }
    .amount-in-words-label {
      font-size: 10px;
      color: #666;
      text-transform: uppercase;
      margin-bottom: 5px;
    }
    .footer {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #e5e7eb;
    }
    .terms {
      margin-bottom: 20px;
    }
    .terms h4 {
      font-size: 10px;
      text-transform: uppercase;
      color: #666;
      margin-bottom: 8px;
    }
    .terms p {
      color: #555;
      font-size: 10px;
    }
    .signatures {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-top: 60px;
    }
    .signature-box {
      text-align: center;
    }
    .signature-line {
      border-top: 1px solid #333;
      margin-top: 50px;
      padding-top: 10px;
    }
    .print-info {
      margin-top: 30px;
      text-align: center;
      font-size: 9px;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="company-info">
      {{#if company.logo}}
      <img src="{{company.logo}}" alt="{{company.name}}" style="max-height: 60px; margin-bottom: 10px;">
      {{/if}}
      <div class="company-name">{{default company.name tenant.name}}</div>
      <div class="company-details">
        {{#if company.address}}{{company.address}}<br>{{/if}}
        {{#if company.phone}}Tel: {{company.phone}}<br>{{/if}}
        {{#if company.email}}Email: {{company.email}}<br>{{/if}}
        {{#if company.taxId}}Tax ID: {{company.taxId}}{{/if}}
      </div>
    </div>
    <div class="document-info">
      <div class="document-title">{{uppercase doctype}}</div>
      <div class="document-number">{{doc.name}}</div>
      <div class="document-date">
        Date: {{formatDate doc.postingDate 'long'}}<br>
        {{#if doc.dueDate}}Due: {{formatDate doc.dueDate 'long'}}{{/if}}
      </div>
    </div>
  </div>

  <div class="parties">
    <div class="party-section">
      <h3>Bill To</h3>
      <div class="party-name">{{doc.customerName}}</div>
      <div class="party-address">{{doc.customerAddress}}</div>
      {{#if doc.customerTaxId}}
      <div style="margin-top: 5px; font-size: 10px; color: #666;">Tax ID: {{doc.customerTaxId}}</div>
      {{/if}}
    </div>
    {{#if doc.shippingAddress}}
    <div class="party-section">
      <h3>Ship To</h3>
      <div class="party-address">{{doc.shippingAddress}}</div>
    </div>
    {{/if}}
  </div>

  {{#if doc.referenceNo}}
  <div style="margin-bottom: 20px; padding: 10px; background: #f9fafb; border-radius: 4px;">
    <strong>Reference:</strong> {{doc.referenceNo}}
    {{#if doc.salesOrderNo}} | <strong>Sales Order:</strong> {{doc.salesOrderNo}}{{/if}}
    {{#if doc.deliveryNoteNo}} | <strong>Delivery Note:</strong> {{doc.deliveryNoteNo}}{{/if}}
  </div>
  {{/if}}

  <table class="items-table">
    <thead>
      <tr>
        <th style="width: 5%;">#</th>
        <th style="width: 15%;">Item Code</th>
        <th style="width: 30%;">Description</th>
        <th class="text-center" style="width: 10%;">Qty</th>
        <th class="text-center" style="width: 8%;">UOM</th>
        <th class="text-right" style="width: 12%;">Rate</th>
        <th class="text-right" style="width: 10%;">Tax</th>
        <th class="text-right" style="width: 12%;">Amount</th>
      </tr>
    </thead>
    <tbody>
      {{#each doc.items}}
      <tr>
        <td>{{rowNumber @index}}</td>
        <td class="item-code">{{itemCode}}</td>
        <td>
          {{itemName}}
          {{#if description}}<div class="item-description">{{description}}</div>{{/if}}
        </td>
        <td class="text-center">{{formatNumber qty 2}}</td>
        <td class="text-center">{{uom}}</td>
        <td class="text-right">{{formatNumber rate 2}}</td>
        <td class="text-right">{{formatNumber taxAmount 2}}</td>
        <td class="text-right">{{formatNumber amount 2}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>

  <div class="totals-section">
    <table class="totals-table">
      <tr>
        <td>Subtotal:</td>
        <td>{{formatCurrency doc.subtotal doc.currency}}</td>
      </tr>
      {{#if doc.discountAmount}}
      <tr>
        <td>Discount:</td>
        <td>-{{formatCurrency doc.discountAmount doc.currency}}</td>
      </tr>
      {{/if}}
      {{#each doc.taxes}}
      <tr>
        <td>{{taxName}} ({{taxRate}}%):</td>
        <td>{{formatCurrency taxAmount ../doc.currency}}</td>
      </tr>
      {{/each}}
      {{#if doc.roundingAdjustment}}
      <tr>
        <td>Rounding:</td>
        <td>{{formatCurrency doc.roundingAdjustment doc.currency}}</td>
      </tr>
      {{/if}}
      <tr class="grand-total">
        <td>Grand Total:</td>
        <td>{{formatCurrency doc.grandTotal doc.currency}}</td>
      </tr>
    </table>
  </div>

  <div class="amount-in-words">
    <div class="amount-in-words-label">Amount in Words</div>
    <div>{{amountInWords doc.grandTotal doc.currency}}</div>
  </div>

  {{#if doc.terms}}
  <div class="footer">
    <div class="terms">
      <h4>Terms & Conditions</h4>
      <p>{{doc.terms}}</p>
    </div>
  </div>
  {{/if}}

  {{#if doc.notes}}
  <div class="footer">
    <div class="terms">
      <h4>Notes</h4>
      <p>{{doc.notes}}</p>
    </div>
  </div>
  {{/if}}

  <div class="signatures">
    <div class="signature-box">
      <div class="signature-line">Authorized Signature</div>
    </div>
    <div class="signature-box">
      <div class="signature-line">Customer Signature</div>
    </div>
  </div>

  <div class="print-info">
    Printed on {{printDate}} at {{printTime}} {{#if user}}by {{user.name}}{{/if}}
  </div>
</body>
</html>
